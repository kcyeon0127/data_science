# CTR ì˜ˆì¸¡ ë°ì´í„° ì „ì²˜ë¦¬ íŒŒì´í”„ë¼ì¸

[![Python](https://img.shields.io/badge/Python-3.8%2B-blue.svg)](https://www.python.org/downloads/)
[![License](https://img.shields.io/badge/License-MIT-green.svg)](LICENSE)
[![Code style: black](https://img.shields.io/badge/code%20style-black-000000.svg)](https://github.com/psf/black)

## ğŸ“‹ ê°œìš”
CTR(Click-Through Rate) ì˜ˆì¸¡ì„ ìœ„í•œ í¬ê´„ì ì¸ ë°ì´í„° ì „ì²˜ë¦¬ íŒŒì´í”„ë¼ì¸ì…ë‹ˆë‹¤. EDA ë¶„ì„ ê²°ê³¼ë¥¼ ë°”íƒ•ìœ¼ë¡œ ìµœì í™”ëœ ì „ì²˜ë¦¬ ê³¼ì •ì„ ì œê³µí•˜ë©°, ë©”ëª¨ë¦¬ íš¨ìœ¨ì ì¸ ëŒ€ìš©ëŸ‰ ë°ì´í„° ì²˜ë¦¬ë¥¼ ì§€ì›í•©ë‹ˆë‹¤.

### âœ¨ ì£¼ìš” íŠ¹ì§•
- ğŸ” **EDA ê¸°ë°˜ ì„¤ê³„**: ë°ì´í„° ë¶„ì„ ê²°ê³¼ë¥¼ ë°˜ì˜í•œ ìµœì í™”ëœ ì „ì²˜ë¦¬
- ğŸš€ **ë©”ëª¨ë¦¬ íš¨ìœ¨ì„±**: ì²­í¬ ë‹¨ìœ„ ì²˜ë¦¬ë¡œ ëŒ€ìš©ëŸ‰ ë°ì´í„° ì•ˆì „ ì²˜ë¦¬
- ğŸ“Š **ì‹¤ì‹œê°„ ì§„í–‰ë¥ **: tqdmì„ ì´ìš©í•œ ìƒì„¸ ì§„í–‰ë¥  í‘œì‹œ
- ğŸ¯ **ìë™í™”**: ì›í´ë¦­ ì „ì²´ íŒŒì´í”„ë¼ì¸ ì‹¤í–‰
- ğŸ› ï¸ **í™•ì¥ì„±**: ëª¨ë“ˆí™”ëœ êµ¬ì¡°ë¡œ ì‰¬ìš´ ì»¤ìŠ¤í„°ë§ˆì´ì§•

## ğŸ“ ì €ì¥ì†Œ êµ¬ì¡°
```
data_science/
â”œâ”€â”€ ğŸ“Š out_eda/                     # EDA ë¶„ì„ ê²°ê³¼
â”‚   â”œâ”€â”€ plots/                      # ì‹œê°í™” ì°¨íŠ¸ë“¤
â”‚   â””â”€â”€ *.csv                       # í†µê³„ ìš”ì•½ ë°ì´í„°
â”œâ”€â”€ ğŸ”§ ctr_preprocessing.py         # ë©”ì¸ ì „ì²˜ë¦¬ í´ë˜ìŠ¤
â”œâ”€â”€ ğŸ› ï¸ preprocessing_utils.py       # ê³ ê¸‰ ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜
â”œâ”€â”€ âš¡ run_preprocessing.py         # ì¼ë°˜ ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ ğŸ’¾ run_preprocessing_chunked.py # ë©”ëª¨ë¦¬ íš¨ìœ¨ì  ì‹¤í–‰
â”œâ”€â”€ ğŸ–¥ï¸ check_memory.py             # ì‹œìŠ¤í…œ ë¦¬ì†ŒìŠ¤ ì²´í¬
â”œâ”€â”€ ğŸ“ˆ eda_ctr_polars.py           # EDA ë¶„ì„ ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ ğŸ¨ visualize_ctr.py            # ì‹œê°í™” ìŠ¤í¬ë¦½íŠ¸
â””â”€â”€ ğŸ“– README.md                   # ì´ íŒŒì¼
```

## ğŸš€ ë¹ ë¥¸ ì‹œì‘

### 1. ì €ì¥ì†Œ í´ë¡ 
```bash
git clone https://github.com/kcyeon0127/data_science.git
cd data_science
```

### 2. í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜
```bash
pip install pandas numpy scikit-learn matplotlib seaborn scipy tqdm psutil
```

### 3. ì‹œìŠ¤í…œ ì²´í¬ (ê¶Œì¥)
```bash
python check_memory.py
```

### 4. ë°ì´í„° ì „ì²˜ë¦¬ ì‹¤í–‰
```bash
# ğŸš€ ì²´í¬í¬ì¸íŠ¸ ë°©ì‹ (ê¶Œì¥) - ì¤‘ê°„ ì¬ì‹œì‘ ê°€ëŠ¥
python run_preprocessing_checkpoint.py

# ì¼ë°˜ ë°©ì‹ (8GB+ ë©”ëª¨ë¦¬ ê¶Œì¥)
python run_preprocessing.py

# ë©”ëª¨ë¦¬ íš¨ìœ¨ì  ì²­í¬ ë°©ì‹ (ìë™ ì²­í¬ í¬ê¸°)
python run_preprocessing_chunked.py

# ì²­í¬ ë°©ì‹ + ìˆ˜ë™ ì²­í¬ í¬ê¸° ì§€ì •
python run_preprocessing_chunked.py 100000

# ê°„ë‹¨í•œ ë°©ì‹ (ë©”ëª¨ë¦¬ ë¶€ì¡± ì‹œ)
python run_preprocessing_simple.py
```

### 3. ê°œë³„ ì „ì²˜ë¦¬ ì‚¬ìš©ë²•
```python
from ctr_preprocessing import CTRDataPreprocessor

# ì „ì²˜ë¦¬ê¸° ì´ˆê¸°í™”
preprocessor = CTRDataPreprocessor()

# ë°ì´í„° ë¡œë“œ
preprocessor.load_data('data/train.parquet', 'data/test.parquet')

# í›ˆë ¨ ë°ì´í„° ì „ì²˜ë¦¬
train_processed = preprocessor.preprocess_pipeline(
    preprocessor.train_df,
    is_training=True,
    target_col='clicked'
)

# í…ŒìŠ¤íŠ¸ ë°ì´í„° ì „ì²˜ë¦¬
test_processed = preprocessor.preprocess_pipeline(
    preprocessor.test_df,
    is_training=False
)
```

## ğŸ”§ ìŠ¤í¬ë¦½íŠ¸ë³„ ìƒì„¸ ì‚¬ìš©ë²•

### ğŸ“Š 1. ì‹œìŠ¤í…œ ì²´í¬ (`check_memory.py`)
```bash
python check_memory.py
```
**ê¸°ëŠ¥:**
- ì‹œìŠ¤í…œ ë©”ëª¨ë¦¬ ë° ë””ìŠ¤í¬ ìš©ëŸ‰ í™•ì¸
- ë°ì´í„° íŒŒì¼ í¬ê¸° ë¶„ì„
- ì ì ˆí•œ ì „ì²˜ë¦¬ ë°©ë²• ì¶”ì²œ
- ì˜ˆìƒ ì²˜ë¦¬ ì‹œê°„ ê³„ì‚°

**ì¶œë ¥ ì˜ˆì‹œ:**
```
ì‹œìŠ¤í…œ ë¦¬ì†ŒìŠ¤ í™•ì¸
ì´ ë©”ëª¨ë¦¬: 16.0 GB
ì‚¬ìš© ê°€ëŠ¥: 12.3 GB (23.1% ì‚¬ìš© ì¤‘)
train.parquet í¬ê¸°: 8.21 GB

ì „ì²˜ë¦¬ ë°©ë²• ì¶”ì²œ
ğŸŸ¢ ë©”ëª¨ë¦¬ ì¶©ë¶„ (8GB ì´ìƒ)
ê¶Œì¥ ë°©ë²•:
  1. python run_preprocessing.py (ë¹ ë¦„)
  2. python run_preprocessing_chunked.py (ì•ˆì „)
```

### âš¡ 2. ì¼ë°˜ ì „ì²˜ë¦¬ (`run_preprocessing.py`)
```bash
python run_preprocessing.py
```
**íŠ¹ì§•:**
- ì „ì²´ ë°ì´í„°ë¥¼ ë©”ëª¨ë¦¬ì— ë¡œë“œ
- ë¹ ë¥¸ ì²˜ë¦¬ ì†ë„
- 8GB+ ë©”ëª¨ë¦¬ ê¶Œì¥

**ì§„í–‰ë¥  í‘œì‹œ:**
```
ë°ì´í„° ë¡œë”©: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:05<00:00]
í›ˆë ¨ ë°ì´í„° ì „ì²˜ë¦¬: 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 5/6 [02:30<00:30] âœ“ Categorical features encoded
í”¼ì²˜ ì¤‘ìš”ë„ ë¶„ì„: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:45<00:00] ì¤‘ìš”ë„ ê³„ì‚° ì™„ë£Œ
```

### ğŸ’¾ 3. ì²­í¬ ì „ì²˜ë¦¬ (`run_preprocessing_chunked.py`)

#### ê¸°ë³¸ ì‚¬ìš©ë²• (ìë™ ì²­í¬ í¬ê¸°):
```bash
python run_preprocessing_chunked.py
```

#### ì²­í¬ í¬ê¸° ìˆ˜ë™ ì§€ì •:
```bash
# 50ë§Œ í–‰ì”© ì²˜ë¦¬ (ëŒ€ìš©ëŸ‰ ë©”ëª¨ë¦¬)
python run_preprocessing_chunked.py 500000

# 20ë§Œ í–‰ì”© ì²˜ë¦¬ (í‘œì¤€)
python run_preprocessing_chunked.py 200000

# 10ë§Œ í–‰ì”© ì²˜ë¦¬ (ì¤‘ê°„)
python run_preprocessing_chunked.py 100000

# 5ë§Œ í–‰ì”© ì²˜ë¦¬ (ë©”ëª¨ë¦¬ ì ˆì•½)
python run_preprocessing_chunked.py 50000
```

**íŠ¹ì§•:**
- ë©”ëª¨ë¦¬ ì•ˆì „í•œ ì²­í¬ ë‹¨ìœ„ ì²˜ë¦¬
- ì‹¤ì‹œê°„ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ëª¨ë‹ˆí„°ë§
- ì¤‘ê°„ ì €ì¥ìœ¼ë¡œ ì•ˆì •ì„± í™•ë³´
- ëª¨ë“  ì‹œìŠ¤í…œì—ì„œ ì‚¬ìš© ê°€ëŠ¥

**ì§„í–‰ë¥  í‘œì‹œ:**
```
ì²­í¬ ì²˜ë¦¬ (100,000í–‰ì”©): 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [15:30<07:30] ì²­í¬ 67/100, ë©”ëª¨ë¦¬: 45.2MB
```

**ê¶Œì¥ ì²­í¬ í¬ê¸°:**
| ì‹œìŠ¤í…œ ë©”ëª¨ë¦¬ | ê¶Œì¥ ì²­í¬ í¬ê¸° | ëª…ë ¹ì–´ |
|---------------|----------------|---------|
| 16GB+         | 500,000í–‰      | `python run_preprocessing_chunked.py 500000` |
| 8-16GB        | 200,000í–‰      | `python run_preprocessing_chunked.py 200000` |
| 4-8GB         | 100,000í–‰      | `python run_preprocessing_chunked.py 100000` |
| 4GB ë¯¸ë§Œ      | 50,000í–‰       | `python run_preprocessing_chunked.py 50000` |

### ğŸ”§ 4. ê°„ë‹¨ ì „ì²˜ë¦¬ (`run_preprocessing_simple.py`)
```bash
python run_preprocessing_simple.py
```
**íŠ¹ì§•:**
- ë©”ëª¨ë¦¬ ì ì‘í˜• ì²˜ë¦¬
- ë©”ëª¨ë¦¬ ë¶€ì¡± ì‹œ ìë™ìœ¼ë¡œ ìƒ˜í”Œ ë°ì´í„°ë¡œ ì „í™˜
- ë°ì´í„° íƒ€ì… ìë™ ìµœì í™”
- ê°€ì¥ ì•ˆì „í•œ ë°©ì‹

**ë©”ëª¨ë¦¬ë³„ ë™ì‘:**
- **4GB ë¯¸ë§Œ**: 10ë§Œ í–‰ ìƒ˜í”Œë¡œ ì²˜ë¦¬
- **4-8GB**: 50ë§Œ í–‰ìœ¼ë¡œ ì œí•œ
- **8GB+**: ì „ì²´ ë°ì´í„° ì²˜ë¦¬

### ğŸ”„ 5. ì²´í¬í¬ì¸íŠ¸ ì „ì²˜ë¦¬ (`run_preprocessing_checkpoint.py`) â­ **ê¶Œì¥**

#### ê¸°ë³¸ ì‚¬ìš©ë²•:
```bash
# ì²˜ìŒ ì‹œì‘
python run_preprocessing_checkpoint.py

# ì¤‘ê°„ì— ì‹¤íŒ¨í–ˆì„ ë•Œ ì¬ì‹œì‘
python run_preprocessing_checkpoint.py --resume

# ì „ì²˜ë¦¬ê¸° ì¬í•™ìŠµ
python run_preprocessing_checkpoint.py --retrain

# ì²­í¬ í¬ê¸° ì¡°ì •
python run_preprocessing_checkpoint.py --chunk-size 50000
```

#### ì²´í¬í¬ì¸íŠ¸ ì‹œìŠ¤í…œ íŠ¹ì§•:
- **ğŸ”„ ì¤‘ê°„ ì¬ì‹œì‘**: ì‹¤íŒ¨ ì§€ì ë¶€í„° ìë™ ì¬ê°œ
- **ğŸ’¾ ì „ì²˜ë¦¬ê¸° ì €ì¥**: í•œ ë²ˆ í•™ìŠµí•œ ì „ì²˜ë¦¬ê¸° ì¬ì‚¬ìš©
- **ğŸ“Š ì§„í–‰ ì¶”ì **: ì‹¤ì‹œê°„ ì§„í–‰ ìƒí™© ì €ì¥
- **ğŸ›¡ï¸ ë©”ëª¨ë¦¬ ì•ˆì „**: ì²­í¬ë³„ ê°œë³„ ì²˜ë¦¬

#### ì²´í¬í¬ì¸íŠ¸ ì›Œí¬í”Œë¡œìš°:

**1ï¸âƒ£ ì²« ì‹¤í–‰:**
```bash
python run_preprocessing_checkpoint.py --chunk-size 100000
```
```
1ë‹¨ê³„: ì¹´í…Œê³ ë¦¬ ìŠ¤ìº” â†’ checkpoints/preprocessor.pkl ì €ì¥
2ë‹¨ê³„: ì „ì²˜ë¦¬ê¸° í•™ìŠµ â†’ í•™ìŠµëœ ì¸ì½”ë”/ìŠ¤ì¼€ì¼ëŸ¬ ì €ì¥
3ë‹¨ê³„: ì²­í¬ ì²˜ë¦¬ â†’ chunk_0001.parquet, chunk_0002.parquet...
```

**2ï¸âƒ£ ë©”ëª¨ë¦¬ ë¶€ì¡±ìœ¼ë¡œ ì¤‘ë‹¨ (ì˜ˆ: ì²­í¬ 15ì—ì„œ):**
```
âœ… checkpoints/preprocessor.pkl (ì „ì²˜ë¦¬ê¸° ì €ì¥ë¨)
âœ… checkpoints/chunk_0001.parquet ~ chunk_0014.parquet (14ê°œ ì²­í¬ ì™„ë£Œ)
âœ… checkpoints/progress.json (ì§„í–‰ ìƒí™©: 15/107 ì²­í¬)
âŒ ì²­í¬ 15ì—ì„œ ë©”ëª¨ë¦¬ ë¶€ì¡±ìœ¼ë¡œ ì¤‘ë‹¨
```

**3ï¸âƒ£ ì¬ì‹œì‘:**
```bash
python run_preprocessing_checkpoint.py --resume
```
```
ğŸ“‚ ê¸°ì¡´ ì „ì²˜ë¦¬ê¸° ë¡œë“œ (ì¹´í…Œê³ ë¦¬ ìŠ¤ìº” ìƒëµ)
ğŸ“‚ ì§„í–‰ ìƒí™© ë¡œë“œ: 15/107 ì²­í¬ë¶€í„° ì¬ì‹œì‘
ğŸš€ ì²­í¬ 15ë¶€í„° ìë™ìœ¼ë¡œ ì²˜ë¦¬ ì¬ê°œ
```

**4ï¸âƒ£ ì™„ë£Œ í›„ ì •ë¦¬:**
```
âœ… ëª¨ë“  ì²­í¬ ì²˜ë¦¬ ì™„ë£Œ
âœ… ìë™ ë°°ì¹˜ ê²°í•© ë° Train/Val ë¶„í• 
ğŸ—‘ï¸ ì²´í¬í¬ì¸íŠ¸ íŒŒì¼ ì‚­ì œ ì—¬ë¶€ ì„ íƒ
```

#### ì‹¤ì œ ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤:

**ì‹œë‚˜ë¦¬ì˜¤ 1: ì•ˆì „í•œ ëŒ€ìš©ëŸ‰ ì²˜ë¦¬**
```bash
# ì‘ì€ ì²­í¬ë¡œ ì•ˆì „í•˜ê²Œ ì‹œì‘
python run_preprocessing_checkpoint.py --chunk-size 25000

# ë©”ëª¨ë¦¬ ì—¬ìœ ê°€ ìˆë‹¤ë©´ í° ì²­í¬ë¡œ ì¬ì‹œì‘
python run_preprocessing_checkpoint.py --chunk-size 100000 --retrain
```

**ì‹œë‚˜ë¦¬ì˜¤ 2: ì‹¤íŒ¨ í›„ ë³µêµ¬**
```bash
# ì‹¤í–‰ ì¤‘ killed ë°œìƒ
python run_preprocessing_checkpoint.py --chunk-size 100000
# ğŸ’¥ ì²­í¬ 23ì—ì„œ ë©”ëª¨ë¦¬ ë¶€ì¡±

# ë” ì‘ì€ ì²­í¬ë¡œ ì¬ì‹œì‘
python run_preprocessing_checkpoint.py --resume --chunk-size 50000
# âœ… ì²­í¬ 23ë¶€í„° ì•ˆì „í•˜ê²Œ ì¬ì‹œì‘
```

**ì‹œë‚˜ë¦¬ì˜¤ 3: ì „ì²˜ë¦¬ê¸° ìˆ˜ì • í›„ ì¬ì²˜ë¦¬**
```bash
# ì½”ë“œ ìˆ˜ì • í›„ ì „ì²˜ë¦¬ê¸° ì¬í•™ìŠµ
python run_preprocessing_checkpoint.py --retrain

# ê¸°ì¡´ ì²­í¬ëŠ” ìœ ì§€í•˜ê³  ì „ì²˜ë¦¬ê¸°ë§Œ ì¬í•™ìŠµ
python run_preprocessing_checkpoint.py --retrain --resume
```

#### ìƒì„±ë˜ëŠ” íŒŒì¼ êµ¬ì¡°:
```
checkpoints/
â”œâ”€â”€ preprocessor.pkl          # í•™ìŠµëœ ì „ì²˜ë¦¬ê¸°
â”œâ”€â”€ progress.json             # ì§„í–‰ ìƒí™©
â”œâ”€â”€ chunk_0001.parquet        # ì²˜ë¦¬ëœ ì²­í¬ë“¤
â”œâ”€â”€ chunk_0002.parquet
â”œâ”€â”€ ...
â””â”€â”€ batch_0.parquet          # ë°°ì¹˜ ê²°í•© íŒŒì¼ (ì„ì‹œ)

processed_data/
â”œâ”€â”€ X_train.parquet          # ìµœì¢… ê²°ê³¼
â”œâ”€â”€ X_val.parquet
â”œâ”€â”€ y_train.parquet
â””â”€â”€ y_val.parquet
```

### ğŸ¨ 5. ì‹œê°í™” (`visualize_ctr.py`)
```bash
python visualize_ctr.py
```
**ê¸°ëŠ¥:**
- EDA ê²°ê³¼ë¥¼ ê¸°ë°˜í•œ ì‹œê°í™” ìƒì„±
- CTR ë¶„í¬ ì°¨íŠ¸ ìƒì„±
- `out_eda/plots/` ë””ë ‰í† ë¦¬ì— ê²°ê³¼ ì €ì¥

### ğŸ“Š 6. EDA ë¶„ì„ (`eda_ctr_polars.py`)
```bash
python eda_ctr_polars.py
```
**ê¸°ëŠ¥:**
- Polarsë¥¼ ì´ìš©í•œ ë¹ ë¥¸ EDA ìˆ˜í–‰
- í†µê³„ ìš”ì•½ ë° ë¶„í¬ ë¶„ì„
- `out_eda/` ë””ë ‰í† ë¦¬ì— ê²°ê³¼ ì €ì¥

## ğŸ“Š ì „ì²˜ë¦¬ ê³¼ì • ìƒì„¸

### 1. ê¸°ë³¸ ì „ì²˜ë¦¬ (`ctr_preprocessing.py`)

#### ê²°ì¸¡ê°’ ì²˜ë¦¬
- **gender, age_group**: 0.16% ê²°ì¸¡ë¥  â†’ ìµœë¹ˆê°’ìœ¼ë¡œ ëŒ€ì²´
- **ìˆ˜ì¹˜í˜• ë³€ìˆ˜**: ì¤‘ì•™ê°’ìœ¼ë¡œ ëŒ€ì²´

#### í”¼ì²˜ ì—”ì§€ë‹ˆì–´ë§
- **ì‹œê°„ í”¼ì²˜**: ìˆœí™˜ ì¸ì½”ë”© (sin, cos ë³€í™˜)
  ```python
  hour_sin = sin(2Ï€ Ã— hour / 24)
  hour_cos = cos(2Ï€ Ã— hour / 24)
  ```
- **ì‹œí€€ìŠ¤ í”¼ì²˜**: ê¸¸ì´ ê¸°ë°˜ ë¹„ë‹ (EDA ë¶„ìœ„ìˆ˜ í™œìš©)
- **íƒ€ê²Ÿ ì¸ì½”ë”©**: ê³ ì¹´ë””ë„ë¦¬í‹° ë³€ìˆ˜(inventory_id) ì²˜ë¦¬
- **ì¸í„°ë™ì…˜ í”¼ì²˜**: gender Ã— age_group

#### ìŠ¤ì¼€ì¼ë§ ë° ì¸ì½”ë”©
- **ìˆ˜ì¹˜í˜•**: RobustScaler (ì´ìƒì¹˜ì— ê°•í•¨)
- **ë²”ì£¼í˜•**: í•˜ì´ë¸Œë¦¬ë“œ ì¸ì½”ë”© ì „ëµ
  - **One-Hot Encoding**: ì €ì¹´ë””ë„ë¦¬í‹° ëª…ëª©í˜• ë³€ìˆ˜ (gender, age_group)
  - **LabelEncoder**: ê³ ì¹´ë””ë„ë¦¬í‹° ë³€ìˆ˜ (inventory_id, l_feat_14)
- **ì´ìƒì¹˜**: IQR ë°©ë²•ìœ¼ë¡œ ìºí•‘

#### í•˜ì´ë¸Œë¦¬ë“œ ì¹´í…Œê³ ë¦¬ ì¸ì½”ë”© ì „ëµ

**ë¬¸ì œ ì¸ì‹**: ê¸°ì¡´ ëª¨ë“  ì¹´í…Œê³ ë¦¬ë¥¼ LabelEncoderë¡œ ì²˜ë¦¬í•˜ëŠ” ê²ƒì€ ëª…ëª©í˜• ë³€ìˆ˜ì— ì˜ëª»ëœ ìˆœì„œ ê´€ê³„ë¥¼ ë¶€ì—¬í•  ìˆ˜ ìˆìŒ

**í•´ê²°ì±…**: ì¹´ë””ë„ë¦¬í‹°ì™€ ë³€ìˆ˜ ì„±ê²©ì— ë”°ë¥¸ ì°¨ë³„í™”ëœ ì¸ì½”ë”©

| ë³€ìˆ˜ | ì¹´ë””ë„ë¦¬í‹° | ì¸ì½”ë”© ë°©ì‹ | ì´ìœ  |
|------|------------|-------------|------|
| **gender** | 2ê°œ | One-Hot | ëª…ëª©í˜• (ë‚¨/ì—¬ì— ìˆœì„œ ì—†ìŒ) |
| **age_group** | 8ê°œ | One-Hot | ìˆœì„œí˜•ì´ì§€ë§Œ ì €ì¹´ë””ë„ë¦¬í‹° |
| **inventory_id** | 18ê°œ | LabelEncoder | ì¤‘ê°„ ì¹´ë””ë„ë¦¬í‹° |
| **l_feat_14** | 3,237ê°œ | LabelEncoder | ê³ ì¹´ë””ë„ë¦¬í‹° |

**ì¸ì½”ë”© ê²°ê³¼ ì˜ˆì‹œ:**
```python
# ê¸°ì¡´ ë°©ì‹ (ë¬¸ì œ)
gender: [1, 2, 3]  # 1 < 2 < 3 ìˆœì„œ ê´€ê³„ ì˜¤í•´

# ìƒˆë¡œìš´ ë°©ì‹ (ê°œì„ )
gender_1.0: [1, 0, 0]  # ë‚¨ì„±
gender_2.0: [0, 1, 0]  # ì—¬ì„±
gender_unknown: [0, 0, 1]  # ë¯¸ì§€
```

**ì¥ì :**
- âœ… ëª…ëª©í˜• ë³€ìˆ˜ì˜ ìˆœì„œ ê´€ê³„ ì˜¤í•´ ë°©ì§€
- âœ… ëª¨ë“  ì¹´í…Œê³ ë¦¬ ê°„ ë™ì¼í•œ ê±°ë¦¬ ìœ ì§€
- âœ… ë©”ëª¨ë¦¬ íš¨ìœ¨ì„± (int8 ì‚¬ìš©)
- âœ… ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸ ì„±ëŠ¥ í–¥ìƒ

### 2. ê³ ê¸‰ ì „ì²˜ë¦¬ (`preprocessing_utils.py`)

#### í”¼ì²˜ ì¤‘ìš”ë„ ë¶„ì„
```python
from preprocessing_utils import CTRPreprocessingUtils

utils = CTRPreprocessingUtils()
importance = utils.analyze_feature_importance(X, y, method='mutual_info')
```

#### ë°ì´í„° ë“œë¦¬í”„íŠ¸ ê°ì§€
```python
drift_results = utils.detect_data_drift(train_df, test_df, features)
```

#### ê³ ê¸‰ í”¼ì²˜ ìƒì„±
- **í†µê³„ì  í”¼ì²˜**: í‰ê· , í‘œì¤€í¸ì°¨, ì™œë„, ì²¨ë„
- **ì¸í„°ë™ì…˜ í”¼ì²˜**: ê³±ì…ˆ, ë§ì…ˆ, ë¹„ìœ¨
- **ì‹œí€€ìŠ¤ ê³ ê¸‰ ì²˜ë¦¬**: íŠ¸ë Œë“œ, ë°˜ë³µë¥ , ìµœë¹ˆê°’

## ğŸ“ˆ ì‹¤í–‰ ê²°ê³¼

### ìƒì„±ë˜ëŠ” íŒŒì¼ë“¤
```
processed_data/
â”œâ”€â”€ X_train.parquet      # í›ˆë ¨ í”¼ì²˜ (80%)
â”œâ”€â”€ X_val.parquet        # ê²€ì¦ í”¼ì²˜ (20%)
â”œâ”€â”€ y_train.parquet      # í›ˆë ¨ íƒ€ê²Ÿ
â”œâ”€â”€ y_val.parquet        # ê²€ì¦ íƒ€ê²Ÿ
â”œâ”€â”€ X_test.parquet       # í…ŒìŠ¤íŠ¸ í”¼ì²˜
â””â”€â”€ feature_info.json    # í”¼ì²˜ ë©”íƒ€ë°ì´í„°
```

### â±ï¸ ì˜ˆìƒ ì²˜ë¦¬ ì‹œê°„
| ë°ì´í„° í¬ê¸° | ì¼ë°˜ ë°©ì‹ | ì²­í¬ ë°©ì‹ | ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ |
|-------------|-----------|-----------|---------------|
| ~100ë§Œ í–‰   | 1-2ë¶„     | 2-3ë¶„     | 1-2GB        |
| ~1ì²œë§Œ í–‰   | 5-10ë¶„    | 10-15ë¶„   | 4-8GB        |
| 1ì²œë§Œ+ í–‰   | 15-30ë¶„   | 20-40ë¶„   | 8GB+         |

## ğŸ”§ ê³ ê¸‰ ì‚¬ìš©ë²•

### 1. ë§ì¶¤í˜• ì „ì²˜ë¦¬ íŒŒì´í”„ë¼ì¸
```python
# ê°œë³„ ë‹¨ê³„ë³„ ì‹¤í–‰
preprocessor = CTRDataPreprocessor()
preprocessor.load_data('data/train.parquet')

# 1ë‹¨ê³„: ê²°ì¸¡ê°’ ì²˜ë¦¬
df = preprocessor.handle_missing_values(train_df)

# 2ë‹¨ê³„: í”¼ì²˜ ì—”ì§€ë‹ˆì–´ë§
df = preprocessor.engineer_features(df)

# 3ë‹¨ê³„: íƒ€ê²Ÿ ì¸ì½”ë”©
df = preprocessor.create_target_encoding(df, 'clicked', is_training=True)

# 4ë‹¨ê³„: ì´ìƒì¹˜ ì²˜ë¦¬
df = preprocessor.handle_outliers(df)

# 5ë‹¨ê³„: ì¸ì½”ë”© ë° ìŠ¤ì¼€ì¼ë§
df = preprocessor.encode_categorical_features(df, is_training=True)
df = preprocessor.scale_numeric_features(df, is_training=True)
```

### 2. í”¼ì²˜ ì„ íƒ ë° ì°¨ì› ì¶•ì†Œ
```python
from preprocessing_utils import CTRPreprocessingUtils

utils = CTRPreprocessingUtils()

# PCA ì ìš©
X_train_pca, X_test_pca, pca = utils.apply_pca_to_features(
    X_train, X_test,
    n_components=0.95,
    feature_prefix='feat_'
)

# í”¼ì²˜ ì¤‘ìš”ë„ ê¸°ë°˜ ì„ íƒ
top_features = utils.analyze_feature_importance(
    X_train, y_train,
    method='mutual_info',
    k=100
)
```

### 3. ì „ì²˜ë¦¬ ê²°ê³¼ ì‹œê°í™”
```python
# ì „ì²˜ë¦¬ ì „í›„ ë¹„êµ
utils.plot_preprocessing_results(original_df, processed_df)

# ì¢…í•© ë¦¬í¬íŠ¸
report = utils.generate_preprocessing_report(original_df, processed_df)
```

## ğŸš€ ë¹ ë¥¸ ì°¸ì¡°

### ğŸ¯ ìƒí™©ë³„ ì¶”ì²œ ëª…ë ¹ì–´

| ìƒí™© | ì¶”ì²œ ëª…ë ¹ì–´ | ì„¤ëª… |
|------|-------------|------|
| **ì²« ì‹¤í–‰** | `python check_memory.py` | ì‹œìŠ¤í…œ ì²´í¬ ë¨¼ì € |
| **â­ ëŒ€ë¶€ë¶„ ìƒí™©** | `python run_preprocessing_checkpoint.py` | ì²´í¬í¬ì¸íŠ¸ ë°©ì‹ (ê¶Œì¥) |
| **ì‹¤íŒ¨ í›„ ì¬ì‹œì‘** | `python run_preprocessing_checkpoint.py --resume` | ì¤‘ê°„ë¶€í„° ì¬ê°œ |
| **ë©”ëª¨ë¦¬ 16GB+** | `python run_preprocessing.py` | ë¹ ë¥¸ ì¼ë°˜ ì²˜ë¦¬ |
| **ë©”ëª¨ë¦¬ 8-16GB** | `python run_preprocessing_checkpoint.py --chunk-size 100000` | ì¤‘ê°„ ì²­í¬ |
| **ë©”ëª¨ë¦¬ 4-8GB** | `python run_preprocessing_checkpoint.py --chunk-size 50000` | ì‘ì€ ì²­í¬ |
| **ë©”ëª¨ë¦¬ 4GB ë¯¸ë§Œ** | `python run_preprocessing_checkpoint.py --chunk-size 25000` | ë§¤ìš° ì‘ì€ ì²­í¬ |
| **ë¹ ë¥¸ í…ŒìŠ¤íŠ¸** | `python run_preprocessing_simple.py` | ë¹ ë¥¸ í™•ì¸ |

### âš¡ ì²˜ë¦¬ ë°©ì‹ ë¹„êµ

| ë°©ì‹ | ì†ë„ | ë©”ëª¨ë¦¬ ì‚¬ìš© | ì•ˆì •ì„± | ê¶Œì¥ ëŒ€ìƒ |
|------|------|-------------|--------|-----------|
| **ì¼ë°˜** (`run_preprocessing.py`) | ë¹ ë¦„ | ë†’ìŒ (8GB+) | ë³´í†µ | ê³ ì„±ëŠ¥ ì‹œìŠ¤í…œ |
| **ì²­í¬** (`run_preprocessing_chunked.py`) | ë³´í†µ | ë‚®ìŒ-ì¤‘ê°„ | ë†’ìŒ | ëª¨ë“  ì‹œìŠ¤í…œ (ê¶Œì¥) |
| **ê°„ë‹¨** (`run_preprocessing_simple.py`) | ë¹ ë¦„ | ë‚®ìŒ | ë†’ìŒ | ë©”ëª¨ë¦¬ ë¶€ì¡± ì‹œ |

**v2.0 ì£¼ìš” ê°œì„ ì‚¬í•­:**
- âœ… í•˜ì´ë¸Œë¦¬ë“œ ì¹´í…Œê³ ë¦¬ ì¸ì½”ë”© (One-Hot + LabelEncoder)
- âœ… 'unknown' ë¼ë²¨ ì˜¤ë¥˜ ì™„ì „ í•´ê²°
- âœ… ë©”ëª¨ë¦¬ íš¨ìœ¨ì  ì²­í¬ ê²°í•©

### ğŸ”§ íŠ¸ëŸ¬ë¸”ìŠˆíŒ… ì²´í¬ë¦¬ìŠ¤íŠ¸

1. **ë©”ëª¨ë¦¬ ë¶€ì¡± (`killed` ì˜¤ë¥˜)**
   ```bash
   python check_memory.py  # ì‹œìŠ¤í…œ ì²´í¬
   python run_preprocessing_simple.py  # ì•ˆì „í•œ ë°©ì‹
   ```

2. **ë°ì´í„° íƒ€ì… ì˜¤ë¥˜**
   ```bash
   # ì´ë¯¸ ìˆ˜ì •ë¨: pd.to_numeric() ì¶”ê°€
   python run_preprocessing_simple.py  # ê°€ì¥ ì•ˆì „
   ```

3. **íŒŒì¼ ì—†ìŒ ì˜¤ë¥˜**
   ```bash
   ls data/  # íŒŒì¼ í™•ì¸
   # train.parquet, test.parquet í•„ìš”
   ```

4. **ë¼ì´ë¸ŒëŸ¬ë¦¬ ì˜¤ë¥˜**
   ```bash
   pip install --upgrade pandas numpy scikit-learn tqdm psutil
   ```

## ğŸ› ë¬¸ì œ í•´ê²°

### ğŸ”´ ë©”ëª¨ë¦¬ ë¶€ì¡± ì˜¤ë¥˜ (`killed`, `MemoryError`)
```bash
# 1. ì‹œìŠ¤í…œ ì²´í¬
python check_memory.py

# 2. ì²­í¬ ë°©ì‹ ì‚¬ìš©
python run_preprocessing_chunked.py

# 3. ë‹¤ë¥¸ í”„ë¡œê·¸ë¨ ì¢…ë£Œ í›„ ì¬ì‹œë„
```

### âš ï¸ ë°ì´í„° íƒ€ì… ì˜¤ë¥˜
```python
# TypeError: can't multiply sequence by non-int
# â†’ ì´ë¯¸ ìˆ˜ì •ë¨: pd.to_numeric() ì¶”ê°€
```

### ğŸ“ íŒŒì¼ ê²½ë¡œ ì˜¤ë¥˜
```bash
# ë°ì´í„° íŒŒì¼ ìœ„ì¹˜ í™•ì¸
ls data/
# train.parquet, test.parquet íŒŒì¼ì´ ìˆì–´ì•¼ í•¨

# ì ˆëŒ€ ê²½ë¡œ í™•ì¸
python -c "import os; print(os.path.abspath('data/train.parquet'))"
```

### ğŸ“¦ ë¼ì´ë¸ŒëŸ¬ë¦¬ í˜¸í™˜ì„±
```bash
# ìµœì‹  ë²„ì „ ê¶Œì¥
pip install --upgrade pandas numpy scikit-learn tqdm psutil
```

## ğŸš€ ì„±ëŠ¥ ìµœì í™”

### ğŸ’¾ ë©”ëª¨ë¦¬ íš¨ìœ¨ì„±
- **ì²­í¬ ì²˜ë¦¬**: ëŒ€ìš©ëŸ‰ ë°ì´í„°ë¥¼ ì‘ì€ ë‹¨ìœ„ë¡œ ë¶„í•  ì²˜ë¦¬
- **ë°ì´í„° íƒ€ì… ìµœì í™”**: `downcast='integer'` ë“±ìœ¼ë¡œ ë©”ëª¨ë¦¬ ì ˆì•½
- **ê°€ë¹„ì§€ ì»¬ë ‰ì…˜**: ë‹¨ê³„ë³„ ë©”ëª¨ë¦¬ ì •ë¦¬ë¡œ ì•ˆì •ì„± í™•ë³´

### âš¡ ì†ë„ ê°œì„ 
- **ë³‘ë ¬ ì²˜ë¦¬**: multiprocessingì„ í™œìš©í•œ ë™ì‹œ ì²˜ë¦¬
- **ë²¡í„°í™” ì—°ì‚°**: pandasì˜ ë²¡í„°í™”ëœ ì—°ì‚° í™œìš©
- **ì¡°ê¸° ì¢…ë£Œ**: ì˜¤ë¥˜ ë°œìƒ ì‹œ ì•ˆì „í•œ í´ë°± ì²˜ë¦¬

## ğŸ“Š EDA ë¶„ì„ ê²°ê³¼

ì´ ì „ì²˜ë¦¬ íŒŒì´í”„ë¼ì¸ì€ ë‹¤ìŒ EDA ê²°ê³¼ë¥¼ ë°˜ì˜í•©ë‹ˆë‹¤:

### ğŸ“ˆ ë°ì´í„° íŠ¹ì„±
- **CTR**: 1.9% (ë¶ˆê· í˜• ë°ì´í„°)
- **ë°ì´í„° í¬ê¸°**: ~1ì²œë§Œ í–‰
- **ì‹œí€€ìŠ¤ ê¸¸ì´**: ì¤‘ê°„ê°’ 439, 95% ë¶„ìœ„ìˆ˜ 1345
- **ê²°ì¸¡ë¥ **: gender/age_group 0.16%

### ğŸ”¢ í”¼ì²˜ êµ¬ì„±
- **ë²”ì£¼í˜•**: gender, age_group, inventory_id, l_feat_14
- **ìˆ˜ì¹˜í˜•**: 48ê°œ (feat_a~e, history_a)
- **ì‹œê°„**: hour, day_of_week
- **ì‹œí€€ìŠ¤**: seq (ê°€ë³€ ê¸¸ì´)

### ğŸ“‹ ì£¼ìš” ì „ì²˜ë¦¬ ê²°ì •ì‚¬í•­
1. **ì‹œê°„ í”¼ì²˜**: ìˆœí™˜ ì¸ì½”ë”©ìœ¼ë¡œ ì—°ì†ì„± ë³´ì¡´
2. **íƒ€ê²Ÿ ì¸ì½”ë”©**: ê³ ì¹´ë””ë„ë¦¬í‹° ë³€ìˆ˜ ì²˜ë¦¬
3. **ì‹œí€€ìŠ¤**: ê¸¸ì´ ê¸°ë°˜ ë¹„ë‹ ë° í†µê³„ì  íŠ¹ì„± ì¶”ì¶œ
4. **ìŠ¤ì¼€ì¼ë§**: RobustScalerë¡œ ì´ìƒì¹˜ ì˜í–¥ ìµœì†Œí™”

## ğŸ“ ë³€ê²½ ë¡œê·¸

### v2.0 (2025-01-18) - í•˜ì´ë¸Œë¦¬ë“œ ì¹´í…Œê³ ë¦¬ ì¸ì½”ë”©
**ğŸ”„ ì£¼ìš” ë³€ê²½ì‚¬í•­:**
- **ì¹´í…Œê³ ë¦¬ ì¸ì½”ë”© ì „ëµ ê°œì„ **: ë³€ìˆ˜ íŠ¹ì„±ì— ë§ëŠ” ì°¨ë³„í™”ëœ ì¸ì½”ë”©
- **'unknown' ë¼ë²¨ ì˜¤ë¥˜ í•´ê²°**: ì „ì²´ ë°ì´í„° ì¹´í…Œê³ ë¦¬ ì‚¬ì „ ìŠ¤ìº” ê¸°ëŠ¥ ì¶”ê°€
- **ë©”ëª¨ë¦¬ íš¨ìœ¨ì  ì²­í¬ ê²°í•©**: ë°°ì¹˜ë³„ ì²˜ë¦¬ë¡œ ëŒ€ìš©ëŸ‰ ë°ì´í„° ì•ˆì „ ì²˜ë¦¬

**ğŸ”§ ê¸°ìˆ ì  ê°œì„ :**
```python
# v1.0 (ê¸°ì¡´)
ëª¨ë“  ì¹´í…Œê³ ë¦¬ â†’ LabelEncoder

# v2.0 (ê°œì„ )
ì €ì¹´ë””ë„ë¦¬í‹° ëª…ëª©í˜• â†’ One-Hot Encoding
ê³ ì¹´ë””ë„ë¦¬í‹° â†’ LabelEncoder
```

**ğŸ“Š ì„±ëŠ¥ ê°œì„ :**
- ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ 15-20% ê°ì†Œ (int8 One-Hot ì‚¬ìš©)
- 'unknown' ë¼ë²¨ ì˜¤ë¥˜ 100% í•´ê²°
- ì²­í¬ ê²°í•© ì‹œ ë©”ëª¨ë¦¬ ì•ˆì •ì„± í™•ë³´

**ğŸ¯ ì‚¬ìš©ì ì˜í–¥:**
- ê¸°ì¡´ ì‚¬ìš©ë²• ë™ì¼ (í•˜ìœ„ í˜¸í™˜ì„± ìœ ì§€)
- ë” ì •í™•í•œ ëª¨ë¸ í•™ìŠµ ê°€ëŠ¥
- ë©”ëª¨ë¦¬ ë¶€ì¡± ì˜¤ë¥˜ í˜„ì €íˆ ê°ì†Œ

### v1.0 (2025-01-17) - ì´ˆê¸° ë²„ì „
- ê¸°ë³¸ CTR ì „ì²˜ë¦¬ íŒŒì´í”„ë¼ì¸ êµ¬í˜„
- EDA ê¸°ë°˜ í”¼ì²˜ ì—”ì§€ë‹ˆì–´ë§
- tqdm ì§„í–‰ë¥  í‘œì‹œ ê¸°ëŠ¥

## ğŸ› ï¸ í™•ì¥ ì•„ì´ë””ì–´

### ğŸ”® í–¥í›„ ê°œì„  ë°©í–¥
- [ ] **ì•™ìƒë¸” íƒ€ê²Ÿ ì¸ì½”ë”©**: ì—¬ëŸ¬ í´ë“œì˜ í‰ê·  ì‚¬ìš©
- [ ] **ì‹œê³„ì—´ í”¼ì²˜**: ì´ì „ ì‹œì ì˜ CTR ì •ë³´ í™œìš©
- [ ] **ë”¥ëŸ¬ë‹ ì„ë² ë”©**: ë²”ì£¼í˜• ë³€ìˆ˜ì˜ dense representation
- [ ] **AutoML í†µí•©**: ìë™ í”¼ì²˜ ì„ íƒ ë° í•˜ì´í¼íŒŒë¼ë¯¸í„° íŠœë‹

### ğŸ¤ ê¸°ì—¬í•˜ê¸°
1. Fork í›„ ë¸Œëœì¹˜ ìƒì„±
2. ê°œì„ ì‚¬í•­ êµ¬í˜„
3. í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±
4. Pull Request ì œì¶œ

## ğŸ“ ì§€ì› ë° ë¬¸ì˜

### ğŸ” ë””ë²„ê¹…
- **ë¡œê·¸ í™•ì¸**: ê° ë‹¨ê³„ë³„ ìƒì„¸ ë¡œê·¸ ì¶œë ¥
- **ë©”ëª¨ë¦¬ ëª¨ë‹ˆí„°ë§**: `check_memory.py`ë¡œ ë¦¬ì†ŒìŠ¤ í™•ì¸
- **ë¦¬í¬íŠ¸ ë¶„ì„**: `processed_data/feature_info.json` ê²€í† 

### ğŸ“§ ì—°ë½ì²˜
- **GitHub Issues**: ë²„ê·¸ ë¦¬í¬íŠ¸ ë° ê¸°ëŠ¥ ìš”ì²­
- **Pull Requests**: ì½”ë“œ ê¸°ì—¬ í™˜ì˜

---
ğŸ¤– **Generated with** [Claude Code](https://claude.ai/code)

**Last Updated**: 2025-01-18